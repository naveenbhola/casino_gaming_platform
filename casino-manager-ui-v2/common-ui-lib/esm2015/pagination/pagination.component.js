import { Component, EventEmitter, Input, Output } from '@angular/core';
import { AppTablesService } from '../app-tables/app-tables.service';
import { UtilityService } from '../services/utility.service';
export class PaginationComponent {
    constructor(tableService, utilityService) {
        this.tableService = tableService;
        this.utilityService = utilityService;
        this.isTableGrid = false;
        this.EMIT_PAGINATION = new EventEmitter();
        this.start = 1;
        this.limit = 10;
        this.currentPage = 1;
        this.totalPage = 1;
    }
    ngOnInit() {
        this.start = (this.inputStart) ? this.inputStart : this.start;
        this.currentPage = (this.inputCurrentPage) ? this.inputCurrentPage : this.currentPage;
        this.limit = this.inputLimit ? this.inputLimit : this.isTableGrid ? 5 : 10;
        this.utilityService.updatePageNumbers.subscribe(() => {
            this.firstPage();
        });
        this.handleSubscription();
    }
    ngOnChanges() {
        this.limit = this.inputLimit ? this.inputLimit : this.isTableGrid ? 5 : this.limit;
        this.totalPage = Math.ceil(this.totalRecord / this.limit) || 1;
    }
    handleSubscription() {
        this.paginationSubscriber = this.tableService.initPagination
            .subscribe(() => {
            this.firstPage();
        });
    }
    nextPage() {
        this.start = this.start + this.limit;
        this.currentPage = this.currentPage + 1;
        this.emitPagination();
    }
    previousPage() {
        this.start = this.start - this.limit;
        this.currentPage = this.currentPage - 1;
        this.emitPagination();
    }
    firstPage() {
        this.start = 1;
        this.currentPage = 1;
        this.emitPagination();
    }
    lastPage() {
        this.start = (Math.ceil(this.totalRecord / this.limit) - 1) * this.limit + 1;
        this.currentPage = Math.ceil(this.totalRecord / this.limit);
        this.emitPagination();
    }
    changePageLimit(limit) {
        this.limit = limit;
        this.currentPage = 1;
        this.start = 1;
        this.totalPage = Math.ceil(this.totalRecord / this.limit);
        this.emitPagination();
    }
    goToAnyPage(event, currntPage) {
        if (event.type === 'keydown' && event.keyCode === 13) {
            if (this.currentPage > this.totalPage) {
                this.start = (this.totalPage - 1) * this.limit + 1;
                this.currentPage = this.totalPage;
                this.emitPagination();
            }
            else {
                if (currntPage > 0) {
                    this.start = (currntPage - 1) * this.limit + 1;
                    this.currentPage = parseInt(currntPage, 10);
                }
                else {
                    this.start = 1;
                    this.currentPage = 1;
                }
                this.emitPagination();
            }
        }
        else if (event.type === 'blur') {
            if (this.currentPage > this.totalPage) {
                this.start = (this.totalPage - 1) * this.limit + 1;
                this.currentPage = this.totalPage;
                this.emitPagination();
            }
            else {
                if (currntPage > 0) {
                    this.start = (currntPage - 1) * this.limit + 1;
                    this.currentPage = parseInt(currntPage, 10);
                }
                else {
                    this.start = 1;
                    this.currentPage = 1;
                }
                this.emitPagination();
            }
        }
    }
    emitPagination() {
        const paginationObj = { start: this.start, limit: this.limit, currentPage: this.currentPage };
        this.EMIT_PAGINATION.emit(paginationObj);
    }
    ngOnDestroy() {
        this.paginationSubscriber.unsubscribe();
    }
}
PaginationComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-pagination',
                template: "<div class=\"pagination__container\">\n  <!-- <div class=\"row\"> -->\n    <!-- <div class=\"col\"> -->\n\n      <div class=\"pagination__contents pagination__contents__center-aligned\">\n\n        <div class=\"pagination__label__inlined\">\n          <mat-form-field class=\"pagination__display-count\">\n            <mat-select [(value)]=\"limit\">\n              <mat-option *ngFor=\"let page of perPageOption\"\n                          [value]=\"page\"\n                          (click)=\"changePageLimit(page)\">{{page}}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n          <p class=\"pagination__label pagination__label__margins\">\n            <span [translate]=\"'application.app.ALERTS_LABELS.PAGINATION.PER_PAGE'\"> per page:</span>\n          </p>\n        </div>\n\n        <button mat-raised-button\n                class=\"common-button pagination__button\"\n                color=\"primary\"\n                (click)=\"firstPage()\"\n                [disabled]=\"start == 1\">\n          <mat-icon>first_page</mat-icon>\n          <span class=\"pr-1\" [translate]=\"'application.app.ALERTS_LABELS.PAGINATION.FIRST'\"> First</span>\n        </button>\n\n        <button mat-raised-button\n                class=\"common-button pagination__button m-0\"\n                color=\"primary\"\n                (click)=\"previousPage()\"\n                [disabled]=\"start == 1\">\n          <mat-icon>chevron_left</mat-icon>\n          <span class=\"pr-2\" [translate]=\"'application.app.ALERTS_LABELS.PAGINATION.PREVIOUS'\"> Previous</span></button>\n\n        <div class=\"pagination-page-label\">\n          <span class=\"mr-3\" [translate]=\"'application.app.ALERTS_LABELS.PAGINATION.PAGE'\">Page</span>\n          <mat-form-field class=\"pagination__display-count text-center\">\n            <input matInput [(ngModel)]=\"currentPage\"\n               (blur)=\"goToAnyPage($event, currentPage)\"\n                   (keydown)=\"goToAnyPage($event, currentPage)\"></mat-form-field>\n            <span [translate]=\"'application.app.ALERTS_LABELS.PAGINATION.OF'\" style=\"padding:0 0.5em;\">of</span> {{totalPage}}\n        </div>\n\n        <button mat-raised-button\n                class=\"common-button pagination__button\"\n                color=\"primary\"\n                (click)=\"nextPage()\"\n                [disabled]=\"start+limit>totalRecord\">\n          <span class=\"pl-1\" [translate]=\"'application.app.ALERTS_LABELS.PAGINATION.NEXT'\">Next </span>\n          <mat-icon>chevron_right</mat-icon>\n        </button>\n\n        <button mat-raised-button\n                class=\"common-button pagination__button\"\n                color=\"primary\"\n                (click)=\"lastPage()\"\n                [disabled]=\"start+limit>totalRecord\">\n          <span class=\"pl-1\" [translate]=\"'application.app.ALERTS_LABELS.PAGINATION.LAST'\">Last </span>\n          <mat-icon>last_page</mat-icon>\n        </button>\n      </div>\n\n    <!-- </div> -->\n  <!-- </div> -->\n</div>\n",
                styles: ["@import url(/opt/wdts/common-ui-v2/node_modules/bootstrap/dist/css/bootstrap.min.css);:root{--accent:#9c1c23;--accent-bright:#ff562d;--accent-dark:#7d161b;--black:#000;--blue:#00ceff;--blue-dark:#00a3cc;--cyan:#23a6ad;--danger:#dc3545;--dark:#333;--dark-light:grey;--gray30:#5a5858;--gray50:#817e7e;--gray80:#d9d8d8;--green-dark:#1c925d;--green-darker:#0a3321;--green-light:#b2f0d5;--info:#0facd2;--primary:#bb9156;--primary-beige:#f0edca;--primary-bg:#eee7dd;--primary-dark:#ab7348;--primary-light:#d9cb9e;--primary-lighten:#e0cdb2;--secondary:#ccc;--secondary-light:#e6e6e6;--success:#22b573;--success-bright:#24ff00;--warning:#fbb03b;--white:#fff;--white-text:#f5f5f5;--yellow:#ff0;--yellow-bright:#ffea00;--yellow-dark:#cc0}body,html{-webkit-font-smoothing:antialiased;font-family:Lato,sans-serif;font-size:16px;font-weight:600;margin:0}html{overflow:hidden!important}.mat-menu-item,.mat-menu-item:focus,a,a:focus,button,button:focus{outline:0!important}button{border-radius:4px}.app-switcher__wrapper.cdk-overlay-pane{position:relative;top:-18vh}.app-switcher__wrapper.cdk-overlay-pane .mat-dialog-container{padding:0!important;position:relative;top:0}::ng-deep .mat-tab-label,::ng-deep .mat-tab-link{font-size:15px;font-weight:600;line-height:inherit}@media only screen and (max-width:1024px) and (max-height:768px){::ng-deep .mat-tab-label,::ng-deep .mat-tab-link{font-size:1em}}.app-spinner{margin:25vh auto 0}.mat-header-cell{font-size:15px}@media only screen and (max-width:1024px) and (max-height:768px){.mat-header-cell{font-size:.8em}}::ng-deep .mat-sort-header-arrow .mat-sort-header-indicator,::ng-deep .mat-sort-header-arrow .mat-sort-header-stem{display:none}::ng-deep .mat-sort-header-sorted .mat-sort-header-arrow .mat-sort-header-indicator,::ng-deep .mat-sort-header-sorted .mat-sort-header-arrow .mat-sort-header-stem{display:block}.fixed-at-top,.sub-nav__fixed-at-top{left:0;position:fixed;top:0;width:100%;z-index:200}.sub-nav__fixed-at-top{top:50px}.wrapper__top-padding{position:relative;top:100px;z-index:100}.text-color__primary{color:#bb9156}::ng-deep .btn-progress-bar{margin-left:-1rem;margin-right:-1rem;min-width:70px;top:-.25rem}.dialog__title{border-bottom:1px solid rgba(0,0,0,.2);display:flex;width:100%}::ng-deep .mat-dialog-title.dialog__title{margin-bottom:10px}.notes__list-item__header-color{color:rgba(0,0,0,.5)}.list-item__wrapper,.text-area__wrapper{background-color:hsla(0,0%,90.2%,.16);border:1px solid #e6e6e6;border-radius:4px;margin-bottom:.5rem;margin-top:1rem;padding:.5rem .5rem 0;width:100%}.list-item__wrapper:first-child,.text-area__wrapper:first-child{margin-top:0}::ng-deep .mat-option .mat-pseudo-checkbox-checked:after{height:5px;top:3.4px;width:10px}::ng-deep .cdk-overlay-pane{max-width:90vw!important}::ng-deep .mat-header-cell,::ng-deep .mat-tab-label,::ng-deep .mat-tab-link{font-size:15px;font-weight:600}::ng-deep .mat-radio-outer-circle{background-color:#fff}.icon-tbl-properties,.icon__tbl-properties{font-size:18px}.icon__hovered{color:#e6e6e6}.icon__hovered:hover{color:#bb9156}.no-data-div,.show__no-data-txt{background-color:rgba(187,145,86,.15);border:1px solid rgba(187,145,86,.3);border-radius:4px;margin:2vh auto 0;max-height:62px;position:relative;text-align:center;top:0;width:50vw}.no-data-div h4,.show__no-data-txt h4{color:#9c1c23;font-size:1.5rem;font-weight:500;margin-bottom:0;margin-top:0;padding:1rem}.material-icons{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;direction:ltr;display:inline-block;font-family:Material Icons;font-feature-settings:\"liga\";font-size:24px;font-style:normal;font-weight:400;letter-spacing:normal;line-height:1;text-rendering:optimizeLegibility;text-transform:none;white-space:nowrap;word-wrap:normal}.text-small{font-size:14px;font-weight:600}.text-base{font-size:16px;font-weight:600}.text-large{font-size:24px;font-weight:600}.text-xlarge{font-size:30px;font-weight:600}.common-button,.select-button{background-color:#fff;border-radius:4px;color:#bb9156;font-weight:600;line-height:2.5}.common-button:focus,.select-button:focus{outline:0}.common-button__sm{line-height:1;min-width:40px;padding:4px 0}.common-button__xsm{margin-left:.25rem;min-width:28px;padding:0}.common-button__xsm:first-child{margin-left:0}.common-button--primary{background-color:#bb9156;color:#fff}.common-button--secondary{border:2px solid #bb9156}.common-button--default{background-color:rgba(0,0,0,.15)}.select-button{min-width:60px}.close-btn{color:rgba(51,51,51,.6)}.close-btn:hover{color:#333}.footer-button__fixed{background-color:#fff;border:1px solid #e6e6e6;border-left:0;border-right:0;bottom:0;display:flex;padding:.5rem 1rem;position:fixed;width:100%;z-index:10}.table-properties__footer-button__margin{margin-left:-1rem}.manrate-button{border-radius:4px;font-size:20px;font-weight:600;min-height:64px;min-width:112px}.table-info__item{border-right:1px solid #fff;padding:0 16px}.table-info__item__left,.table-info__item__right{display:flex;flex-direction:row}.table-info__item__right{justify-content:flex-end}.table-info__item__right:last-child{border-right:0}.table-info__container{-ms-grid-columns:(minmax(80px,1fr))[2];-ms-grid-rows:24px;align-items:stretch;background-color:#000;color:#fff;display:-ms-grid;display:grid;grid-template-columns:repeat(2,minmax(80px,1fr));grid-template-rows:24px;justify-content:space-between}.chptray-chpset__form__select{background-color:#fff;border:2px solid grey;border-radius:4px;font-size:24px;font-weight:600;height:96px;letter-spacing:.2px;line-height:1;margin-bottom:8px;min-width:216px;padding:.5rem;text-align:left;width:100%}@media only screen and (max-width:1368px) and (max-height:768px){.chptray-chpset__form__select{font-size:20px;height:64px;height:72px;min-width:112px;padding:.25rem .5rem;width:100%}}.link-color__primary{color:#bb9156!important}.link-color__primary:hover{color:#7a191b!important}.refresh-btn{align-items:center;cursor:pointer!important;display:flex;height:24px;justify-content:center}.space-filler{flex-grow:1}.negative-value{color:#dc3522!important}.css--arrow-sign{background-color:#000;border-radius:8px;display:inline-block;height:4px;position:relative;width:24px}.css--arrow-sign:after,.css--arrow-sign:before{background-color:#000;border-radius:8px;content:\"\";height:4px;width:14px}.css--arrow-sign:before{position:absolute;right:-4px;top:-4px;transform:rotate(45deg)}.css--arrow-sign:after{position:absolute;right:-4px;top:4px;transform:rotate(-225deg)}.v-line,.vert-line{border-color:hsla(0,0%,100%,.2);color:#fff}.pagination__container{background-color:#fff;border:1px solid #e6e6e6;display:flex;height:65px;width:100%;z-index:990}.pagination__contents{display:flex;flex:1}.pagination__contents__center-aligned{align-items:center;justify-content:center}.pagination__button{margin:0 .5em}.pagination__label{line-height:3.5}.pagination__label__margins{margin:0 .75em 0 .5em}.pagination__label__inlined{display:inline-flex}.pagination__display-count{margin:0 .5em;width:60px}.pagination-page-label{margin:0 .75em}:host{-ms-grid-row-align:end;align-self:end}"]
            },] }
];
PaginationComponent.ctorParameters = () => [
    { type: AppTablesService },
    { type: UtilityService }
];
PaginationComponent.propDecorators = {
    perPageOption: [{ type: Input }],
    totalRecord: [{ type: Input }],
    inputStart: [{ type: Input }],
    inputCurrentPage: [{ type: Input }],
    inputLimit: [{ type: Input }],
    isTableGrid: [{ type: Input }],
    EMIT_PAGINATION: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnaW5hdGlvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9jb21tb24tdWktdjIvc3JjL2FwcC9wYWdpbmF0aW9uL3BhZ2luYXRpb24uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBZ0MsTUFBTSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ25HLE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLGtDQUFrQyxDQUFDO0FBQ2xFLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSw2QkFBNkIsQ0FBQztBQU8zRCxNQUFNLE9BQU8sbUJBQW1CO0lBZTVCLFlBQ1ksWUFBOEIsRUFDOUIsY0FBOEI7UUFEOUIsaUJBQVksR0FBWixZQUFZLENBQWtCO1FBQzlCLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQVhqQyxnQkFBVyxHQUFJLEtBQUssQ0FBQztRQUNwQixvQkFBZSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFFcEQsVUFBSyxHQUFHLENBQUMsQ0FBQztRQUNWLFVBQUssR0FBRyxFQUFFLENBQUM7UUFDWCxnQkFBVyxHQUFHLENBQUMsQ0FBQztRQUNoQixjQUFTLEdBQUcsQ0FBQyxDQUFDO0lBT2QsQ0FBQztJQUVELFFBQVE7UUFDSixJQUFJLENBQUMsS0FBSyxHQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQy9ELElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDO1FBQ3RGLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxD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QyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7b0JBQy9DLElBQUksQ0FBQyxXQUFXLEdBQUcsUUFBUSxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQztpQkFDL0M7cUJBQU07b0JBQ0gsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7b0JBQ2YsSUFBSSxDQUFDLFdBQVcsR0FBRyxDQUFDLENBQUM7aUJBQ3hCO2dCQUNELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQzthQUN6QjtTQUNKO0lBQ0wsQ0FBQztJQUVELGNBQWM7UUFDVixNQUFNLGFBQWEsR0FBRyxFQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxFQUFFLFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVyxFQUFDLENBQUM7UUFDNUYsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVELFdBQVc7UUFDUCxJQUFJLENBQUMsb0JBQW9CLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDNUMsQ0FBQzs7O1lBM0hKLFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUsZ0JBQWdCO2dCQUMxQiw0L0ZBQTBDOzthQUU3Qzs7O1lBUE8sZ0JBQWdCO1lBQ2hCLGNBQWM7Ozs0QkFRakIsS0FBSzswQkFDTCxLQUFLO3lCQUNMLEtBQUs7K0JBQ0wsS0FBSzt5QkFDTCxLQUFLOzBCQUNMLEtBQUs7OEJBQ0wsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSwgT25Jbml0LCBPdXRwdXR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtBcHBUYWJsZXNTZXJ2aWNlfSBmcm9tICcuLi9hcHAtdGFibGVzL2FwcC10YWJsZXMuc2VydmljZSc7XG5pbXBvcnQge1V0aWxpdHlTZXJ2aWNlfSBmcm9tICcuLi9zZXJ2aWNlcy91dGlsaXR5LnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2FwcC1wYWdpbmF0aW9uJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vcGFnaW5hdGlvbi5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vcGFnaW5hdGlvbi5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFBhZ2luYXRpb25Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95IHtcbiAgICBASW5wdXQoKSBwZXJQYWdlT3B0aW9uOiBBcnJheTxudW1iZXI+O1xuICAgIEBJbnB1dCgpIHRvdGFsUmVjb3JkOiBudW1iZXI7XG4gICAgQElucHV0KCkgaW5wdXRTdGFydDogbnVtYmVyO1xuICAgIEBJbnB1dCgpIGlucHV0Q3VycmVudFBhZ2U6IG51bWJlcjtcbiAgICBASW5wdXQoKSBpbnB1dExpbWl0OiBudW1iZXI7XG4gICAgQElucHV0KCkgaXNUYWJsZUdyaWQgPz0gZmFsc2U7XG4gICAgQE91dHB1dCgpIEVNSVRfUEFHSU5BVElPTiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gICAgc3RhcnQgPSAxO1xuICAgIGxpbWl0ID0gMTA7XG4gICAgY3VycmVudFBhZ2UgPSAxO1xuICAgIHRvdGFsUGFnZSA9IDE7XG4gICAgcGFnaW5hdGlvblN1YnNjcmliZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSB0YWJsZVNlcnZpY2U6IEFwcFRhYmxlc1NlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgdXRpbGl0eVNlcnZpY2U6IFV0aWxpdHlTZXJ2aWNlXG4gICAgKSB7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhcnQgPSAgKHRoaXMuaW5wdXRTdGFydCkgPyB0aGlzLmlucHV0U3RhcnQgOiB0aGlzLnN0YXJ0O1xuICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gKHRoaXMuaW5wdXRDdXJyZW50UGFnZSkgPyB0aGlzLmlucHV0Q3VycmVudFBhZ2UgOiB0aGlzLmN1cnJlbnRQYWdlO1xuICAgICAgICB0aGlzLmxpbWl0ID0gdGhpcy5pbnB1dExpbWl0ID8gdGhpcy5pbnB1dExpbWl0IDogdGhpcy5pc1RhYmxlR3JpZCA/IDUgOiAxMDtcbiAgICAgICAgdGhpcy51dGlsaXR5U2VydmljZS51cGRhdGVQYWdlTnVtYmVycy5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maXJzdFBhZ2UoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaGFuZGxlU3Vic2NyaXB0aW9uKCk7XG4gICAgfVxuXG4gICAgbmdPbkNoYW5nZXMoKSB7XG4gICAgICAgIHRoaXMubGltaXQgPSB0aGlzLmlucHV0TGltaXQgPyB0aGlzLmlucHV0TGltaXQgOiB0aGlzLmlzVGFibGVHcmlkID8gNSA6IHRoaXMubGltaXQ7XG4gICAgICAgIHRoaXMudG90YWxQYWdlID0gTWF0aC5jZWlsKHRoaXMudG90YWxSZWNvcmQgLyB0aGlzLmxpbWl0KSB8fCAxO1xuICAgIH1cblxuICAgIGhhbmRsZVN1YnNjcmlwdGlvbigpIHtcbiAgICAgICAgdGhpcy5wYWdpbmF0aW9uU3Vic2NyaWJlciA9IHRoaXMudGFibGVTZXJ2aWNlLmluaXRQYWdpbmF0aW9uXG4gICAgICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpcnN0UGFnZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbmV4dFBhZ2UoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhcnQgPSB0aGlzLnN0YXJ0ICsgdGhpcy5saW1pdDtcbiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IHRoaXMuY3VycmVudFBhZ2UgKyAxO1xuICAgICAgICB0aGlzLmVtaXRQYWdpbmF0aW9uKCk7XG4gICAgfVxuXG4gICAgcHJldmlvdXNQYWdlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXJ0ID0gdGhpcy5zdGFydCAtIHRoaXMubGltaXQ7XG4gICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSB0aGlzLmN1cnJlbnRQYWdlIC0gMTtcbiAgICAgICAgdGhpcy5lbWl0UGFnaW5hdGlvbigpO1xuICAgIH1cblxuICAgIGZpcnN0UGFnZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGFydCA9IDE7XG4gICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAxO1xuICAgICAgICB0aGlzLmVtaXRQYWdpbmF0aW9uKCk7XG4gICAgfVxuXG4gICAgbGFzdFBhZ2UoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhcnQgPSAoTWF0aC5jZWlsKHRoaXMudG90YWxSZWNvcmQgLyB0aGlzLmxpbWl0KSAtIDEpICogdGhpcy5saW1pdCArIDE7XG4gICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSBNYXRoLmNlaWwodGhpcy50b3RhbFJlY29yZCAvIHRoaXMubGltaXQpO1xuICAgICAgICB0aGlzLmVtaXRQYWdpbmF0aW9uKCk7XG4gICAgfVxuXG4gICAgY2hhbmdlUGFnZUxpbWl0KGxpbWl0KTogdm9pZCB7XG4gICAgICAgIHRoaXMubGltaXQgPSBsaW1pdDtcbiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IDE7XG4gICAgICAgIHRoaXMuc3RhcnQgPSAxO1xuICAgICAgICB0aGlzLnRvdGFsUGFnZSA9IE1hdGguY2VpbCh0aGlzLnRvdGFsUmVjb3JkIC8gdGhpcy5saW1pdCk7XG4gICAgICAgIHRoaXMuZW1pdFBhZ2luYXRpb24oKTtcbiAgICB9XG5cbiAgICBnb1RvQW55UGFnZShldmVudCwgY3Vycm50UGFnZSk6IHZvaWQge1xuXG5cbiAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdrZXlkb3duJyAmJiBldmVudC5rZXlDb2RlID09PSAxMykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPiB0aGlzLnRvdGFsUGFnZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQgPSAodGhpcy50b3RhbFBhZ2UgLSAxKSAqIHRoaXMubGltaXQgKyAxO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSB0aGlzLnRvdGFsUGFnZTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRQYWdpbmF0aW9uKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjdXJybnRQYWdlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0ID0gKGN1cnJudFBhZ2UgLSAxKSAqIHRoaXMubGltaXQgKyAxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gcGFyc2VJbnQoY3Vycm50UGFnZSwgMTApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQgPSAxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0UGFnaW5hdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnR5cGUgPT09ICdibHVyJykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPiB0aGlzLnRvdGFsUGFnZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQgPSAodGhpcy50b3RhbFBhZ2UgLSAxKSAqIHRoaXMubGltaXQgKyAxO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSB0aGlzLnRvdGFsUGFnZTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRQYWdpbmF0aW9uKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjdXJybnRQYWdlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0ID0gKGN1cnJudFBhZ2UgLSAxKSAqIHRoaXMubGltaXQgKyAxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gcGFyc2VJbnQoY3Vycm50UGFnZSwgMTApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQgPSAxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0UGFnaW5hdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZW1pdFBhZ2luYXRpb24oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHBhZ2luYXRpb25PYmogPSB7c3RhcnQ6IHRoaXMuc3RhcnQsIGxpbWl0OiB0aGlzLmxpbWl0LCBjdXJyZW50UGFnZTogdGhpcy5jdXJyZW50UGFnZX07XG4gICAgICAgIHRoaXMuRU1JVF9QQUdJTkFUSU9OLmVtaXQocGFnaW5hdGlvbk9iaik7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGFnaW5hdGlvblN1YnNjcmliZXIudW5zdWJzY3JpYmUoKTtcbiAgICB9XG5cbn1cbiJdfQ==